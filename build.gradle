buildscript {
    ext {
        morpherGroupId = 'com.github.szgabsz91'
        morpherVersion = '1.8.0'

        signingKeyId = System.getenv('SIGNING_KEY_ID')
        signingKey = new String(System.getenv('SIGNING_KEY').decodeBase64())
        signingPassword = System.getenv('SIGNING_PASSWORD')
        mavenCentralUsername = System.getenv('MAVEN_CENTRAL_USERNAME')
        mavenCentralPassword = System.getenv('MAVEN_CENTRAL_PASSWORD')

        javaVersion = '21'

        checkstyleVersion = '10.12.4'
        guavaVersion = '32.1.3-jre'
        jacocoVersion = '0.8.11'
        lombokVersion = '1.18.30'
        nexusPublishPlugin = '1.3.0'
        pmdVersion = '6.55.0'
        protobufGradlePluginVersion = '0.9.4'
        protocVersion = '3.25.0'
        publishPluginVersion = '1.3.0'
        spotbugsVersion = '4.8.1'
        spotbugsGradlePluginVersion = '5.2.3'

        combinatoricslibVersion = '3.3.3'
        commonsCollectionsVersion = '4.4'
        commonsLangVersion = '3.13.0'
        commonsTextVersion = '1.11.0'
        gsonVersion = '2.10.1'
        logbackVersion = '1.4.11'
        luceneCoreVersion = '9.8.0'
        protobufVersion = '3.25.0'
        slf4jVersion = '2.0.9'
        velocityVersion = '2.3'
        zip4jVersion = '2.11.5'

        assertjVersion = '3.24.2'
        junitJupiterVersion = '5.10.1'
        junitPlatformVersion = '1.10.1'
        mockitoVersion = '5.7.0'
    }

    repositories {
        mavenLocal()
        mavenCentral()

        maven {
            url 'https://plugins.gradle.org/m2'
        }
    }

    dependencies {
        classpath "com.github.spotbugs.snom:spotbugs-gradle-plugin:${spotbugsGradlePluginVersion}"
        classpath "com.google.protobuf:protobuf-gradle-plugin:${protobufGradlePluginVersion}"
        // Workaround for Spotbugs vs Protobuf:
        // - https://github.com/spotbugs/spotbugs-gradle-plugin/issues/120
        // - https://github.com/GoogleContainerTools/jib/issues/591
        classpath "com.google.guava:guava:${guavaVersion}"
        classpath "io.github.gradle-nexus:publish-plugin:${publishPluginVersion}"
    }
}

gradle.rootProject {
    apply from: "$rootDir/gradle/nexus.gradle"
}

subprojects {
    group = morpherGroupId
    version = morpherVersion

    apply from: "$rootDir/gradle/java.gradle"
    apply from: "$rootDir/gradle/lombok.gradle"
    apply from: "$rootDir/gradle/static-code-analysis.gradle"
    apply from: "$rootDir/gradle/maven.gradle"
    apply from: "$rootDir/gradle/ide.gradle"
    apply from: "$rootDir/gradle/signing.gradle"

    repositories {
        mavenLocal()
        mavenCentral()
    }
}
